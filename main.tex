\documentclass[10pt]{article}

%---------------------------------------------------------------------
\usepackage[a4paper, headsep=-4in,bindingoffset=0in,%
left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm,%
footskip=.25in]{geometry}
\newcommand{\textBF}[1]{%
    \pdfliteral direct {2 Tr 0.3 w} %the second factor is the boldness
     #1%
    \pdfliteral direct {0 Tr 0 w}%
}
\usepackage{multirow}
\usepackage{soul}

\usepackage{xr}
\externaldocument{main}
\def\Plus{\texttt{+}}
%\usepackage[english]{babel}   
\usepackage[utf8]{inputenc}  
\usepackage[font=scriptsize]{caption}
\usepackage{tabularx}
%\DeclareCaptionFont{6pt}{\fontsize{6pt}{6pt}\selectfont}
\captionsetup[figure]{font={stretch=1}}  
%\usepackage{sectsty}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage{layout}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage{listings}
\usepackage{mathptmx}

\usepackage{booktabs}
\usepackage{etoolbox}

\newcommand{\beginsupplement}{%
\setcounter{table}{0}
\renewcommand{\thetable}{S\arabic{table}}%
\setcounter{figure}{0}
\renewcommand{\thefigure}{S\arabic{figure}}%
}

\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage[backend=biber,style=apa,sorting=none]{biblatex}
\addbibresource{paperpile.bib}
%\pagenumbering{gobble}
\pagenumbering{arabic}

\graphicspath{{figs/}}
\setlength{\topmargin}{-10pt}
%\renewcommand{\baselinestretch}{1.5}

\usepackage{indentfirst}
\setlength{\parindent}{1cm}
\usepackage[table]{xcolor}
\setlength{\headsep}{1pt}

\begin{document} 

\begin{center}
{\large \section*{Systematic comparison of imaging biomarkers of chronic stroke motor outcome in the ENIGMA Stroke Recovery Working Group dataset}}
\end{center}

\begin{center}
Emily Olafson$^1$, Keith Jamison$^1$, Bethany Lo$^2$, Sook-Lei Liew$^2$, Amy Kuceyeski$^1$
\end{center}

    1. \textmd{Department of Radiology, Weill Cornell Medical College, New York City, New York, USA, 10021} 

%---------------------------------------------------------------------

\section{Abstract}
Stroke is a leading cause of physical impairment, and up to a third of stroke survivors have poor motor outcomes five years after the event. However, the ability to predict long-term deficits from acute clinical information remains a challenge. Incorporating information about lesion location can improve prediction models, but it is unclear how to optimally use volumetric lesion data to predict chronic motor outcomes. Several lesion biomarkers have been related to stroke motor outcome, but it is unclear whether they can accurately predict chronic impairments across a range of lesion topographies.  This paper presents a comparison of the predictive accuracy of several imaging biomarkers of post-stroke motor impairment using the ENIGMA dataset, a multi-site stroke lesion database. We assess the relative performance of theory-driven features (from the motor system: M1-CST lesion load, as well as parcellations of the CST) vs. data-driven features (derived from inferential lesion-behavior mapping, and features that are derived using a feature selection step in the regression model itself). In this last model, we use whole-brain regional ChaCo scores as inputs and letting the model decide what subset of regions are worth keeping. The models are compared using out-of-sample performance, and the results show that data-driven features outperform theory-driven features. The data-driven features also outperform models trained on chronic subjects when applied to acute subjects. These results highlight the potential of data-driven feature selection in identifying lesion-deficit associations beyond current theory-driven biomarkers.

\section{Introduction}
Stroke is a leading cause of long-term disability worldwide (\cite{Katan2018-qn}), often causing motor impairments that can compromise independence. Accurate and early prognosis for motor recovery after stroke can be used to guide rehabilitation and set treatment goals based on recovery potential, but the ability to predict long-term motor deficits from acute clinical information is still a major challenge (\cite{Stinear2017-eg}).

The location of the lesion in the brain has been related to motor outcomes, but it is unclear how to extract lesion location information in a way that captures the most variance in chronic motor outcomes. Lesion segmentations, derived from acute magnetic resonance imaging (MRI) data, reflect the location and size of the lesion in volumetric space, and can be used to determine which neuroanatomical structures were damaged by the stroke. Several metrics reflecting lesion damage can be extracted from binarized lesion segmentations, typically reflecting damage to specific anatomical structures. The effect of a lesion on the brain's large-scale structural network, in particular, is believed to be related to motor outcomes (\cite{Kuceyeski2016-vj, Griffis2019-cy, Salvalaggio2020-pe, Bowren2022-rs}). However, there is no consensus on how to optimally model lesion-induced disruption of anatomically distributed networks for predictions of chronic motor deficits. 

Damage to areas directly related to motor behaviour have traditionally been used as features for predictive models. The most well-studied damage metric is the corticospinal tract (CST) lesion load, or the proportion of voxels in the ipsilesional corticospinal tract (typically originating from primary motor cortex, M1) that intersect with the lesion (\cite{Zhu2010-qh, Feng2015-du, Findlater2019-je, Lam2018-xh, Pineiro2000-dv}). M1-CST lesion load has been related to motor deficits in the acute and chronic phase of stroke (\cite{Stinear2017-eg, Kim2017-xe}), but M1-CST damage in itself is unlikely to capture enough variance in motor deficits in patients with a wide range of lesion topography (\cite{Findlater2019-je}). Multivariate models that incorporate information about how the lesion damages multiple somatomotor regions beyond M1 better predict post-stroke motor outcomes than models that only include M1-CST lesion load (\cite{Ito2022-em,  Rondina2016-ds, Rondina2017-ij, Schulz2012-yy}). For instance, lesion load to 12 tracts that comprise the descending CST originating from premotor, somatosensory, supplementary motor regions explains chronic motor scores better than lesion load to the primary motor cortex alone (\cite{Ito2022-em}). These features are defined a priori on the basis of their known theoretical involvement in motor function. However, in the context of prediction, where we simply wish to exploit associations between lesion data and motor deficits with the goal of optimizing out-of-sample predictive accuracy, limiting input features to predefined regions in the motor system may limit model performance. In other words, we may want to discover useful lesion-deficit associations in a data-driven way instead of assuming that theory-based structure-function relationships will have maximal predictive value.

Lesion-behavior mapping (LBM) is a technique used to discover neural correlates of a behavioural deficit that involves statistically relating damage to a voxel with presence or degree of a deficit (\cite{Karnath2020-cg, Bates2003-eg}). Maps of association can be derived from multivariate models that relate deficits to patterns of damage across multiple voxels simultaneously (\cite{Ivanova2021-nh, Karnath2020-cg, Zhang2014-jd, Sperber2020-kp}). These  multivariate models generate maps using one of two statistical frameworks: inference or prediction (\cite{Sperber2020-kp, Bzdok2020-py}). In an inference framework, these maps consist of areas in which damage is significantly associated with a deficit, and are considered to be the anatomical localizations of a given function. On the other hand, in a prediction framework, maps are comprised of patterns of voxels in which damage is predictive of impairment in new subjects (\cite{Bowren2022-rs, Mah2014-cb,Rondina2017-ij, Sperber2020-kp, Dulyan2021-jf}). Associations maps derived from the latter, predictive framework may be more suitable as input features to predictive models, given that those maps to some degree already represent features in which damage predicts impairment in new subjects. In light of the importance of the brain's structural network in motor function, \cite{Bowren2022-rs} identify the structural connections that pass through the peak voxels identified with predictive LBM, and use damage to those structural networks as features in predictive models. These features are derived in a data-driven way from predictive multivariate lesion-behavior mapping and have already shown promising predictive potential (\cite{Bowren2022-rs}), but have yet to be cross-validated in an independent dataset. 

Multivariate lesion-behavior mapping analyses (including \cite{Bowren2022-rs}, traditionally use voxelwise volumetric lesion data as features. This raw format may hamper predictive models because of the non-random distribution of lesions -- in some situations, there are very few observations per voxel, and this reduces the statistical power of a model (\cite{Kimberg2007-sk, Rorden2009-ae,Sperber2020-kp}. Relating deficits to the structural disconnection caused by a lesion, in which non-overlapping lesions can map onto damage to the same white matter tract, may be a biologically-relevant way to preserve variance in lesion-deficit relationships while improving statistical power. Using the Network Modification tool (\cite{Kuceyeski2013-nk}), the amount of lesion-induced structural disconnection for each gray matter region in the brain can be estimated. Similar to recent approaches in multivariate lesion behavior mapping (\cite{Kasties2021-rm}), we can further use feature selection to identify regions that are important for predicting chronic motor scores. Selecting features in a data-driven way often requires many subjects, and more still are needed to cross-validate the test performance of such a model. With a large multi-site stroke imaging database (N = 789) (\cite{Liew2020-ps}), we can reliably train and evaluate high-dimensional multivariate models that employ feature selection. 

In this paper, we robustly compare the out-of-sample predictive performance of several lesion damage metrics. First, we assess theory-based metrics: M1-CST lesion load, and sensot


we use feature selection to identify regions in which structural disconnectivity is predictive of chronic motor scores, and evaluate this method against traditional lesion load measures in the motor system and sLNM models.

To do this, we and directly evaluating different representations of lesion data and feature selection to predict chronic motor deficits. With such a heterogeneous sample containing data from multiple imaging sites, Our primary objective was to determine the relative performance of different biomarkers for predicting chronic motor scores, with the hypothesis that data-driven feature selection would improve prediction performance and identify features beyond the current suite of theory-based biomarkers like those in the motor system. As a secondary objective, we assessed whether predictive performance could be improved by incorporating demographic information and by combining predictions from several different biomarkers using ensemble models.

\section{Materials and methods}
\subsection{Sample demographics}
A subset of cross‐sectional data from the Enhancing Neuroimaging Genomics through Meta Analysis (ENIGMA) Stroke Recovery Working Group database (available as of 10 Sept. 2021) was used in the study. Details of the ENIGMA Stroke Recovery procedures and methods are available in (\cite{Liew2020-ps}). The data originated from 22 research studies (sites) (Table \ref{table:Demographics}). Informed consent was obtained from all subjects, and data were collected in compliance with each institution’s local ethical review boards and in accordance with the Declaration of Helsinki.

ENIGMA Stroke Recovery participants with the following data were included: (1) high‐resolution (1‐mm isotropic) T1‐weighted brain MRI (T1w) acquired with a 3T MRI scanner; (2) information about time since stroke at time of imaging (3) age, (4), sex, and (5) measurem of motor function from one of the following assessments: Fugl Meyer Assessment of Upper Extremities (FMA‐UE), a performance-based measure of paretic upper extremity impairment (\cite{Gladstone2002-fw}); the Action Research Arm test (ARAT) which tests arm function through assessment of the timing and difficulty of motor task completion (\cite{Yozbatiran2008-xv}); the Barthel index, which measures the extent to which a person can function independently and has mobility in their activities of daily living (\cite{Sulter1999-rr}); National Institutes of Health Stroke Score (NIHSS), a broad measure of stroke severity that includes assessment of non-motor and motor functions (\cite{Lyden2017-za}). Motor scores were normalized to the range [0, 1] by dividing by the raw score by the maximum possible score on the assessment. For a majority of the chronic stroke subjects (76$\%$), motor deficits are normalized FMA‐UE scores, whereas  normalized FMA‐UE scores were available for only $12\%$ of the acute stroke subjects (for full breakdown of type of test used for each site in the dataset, see Supplementary Table \ref{motor_scores}). Behavioral data were collected within approximately 72 hours of the MRI. Subjects were considered in the chronic phase of stroke if their time since stroke at the time of assessment was greater than 180 days, and considered in the acute phase if their time since stroke at the time of assessment was less than 180 days (\cite{Bernhardt2017-av}). Subjects with cortical and subcortical lesions were included in the study; lesions were not flipped (see Supplementary Figure \ref{lesiondist} for lesion distribution in MNI space). 

\newpage
\begin{table}[h]
\centering
\caption{Demographic information of the ENIGMA dataset, broken down by chronicity (acute/chronic) and by site within each chronicity group. Total sample size (N), number of females (F) and males (M), and information about age (years), normalized motor scores, time since stroke at the time of assessment (months), and lesion volume ($cm^3$). IQR, interquartile range}

\label{table:Demographics}
\begin{tabular}{llllll}
\toprule
Site ID & Total N. & Median age & Median motor  & Median time    & Median lesion vol. \\
& (F/M) & in years (IQR) & score (IQR) &  since stroke  & in $cm^3$ (IQR) \\
 \textbf{Acute}  & & & & in mos. (IQR) & \\
\arrayrulecolor{black!30}\midrule
r005 & 1 (0/1) & 50.0 (0.0) & 0.29 (0.00) & 5.1 (0.0) & 1.69 (0.00) \\
r009 & 50 (13/37) & 70.0 (18.5) & 1.00 (0.05) & 0.2 (0.1) & 1.65 (6.96) \\
r025 & 9 (4/5) & 70.0 (19.0) & 1.00 (0.09) & 3.0 (1.0) & 0.52 (1.44) \\
r028 & 1 (0/1) & 63.0 (0.0) & 0.74 (0.00) & 5.5 (0.0) & 23.87 (0.00) \\
r031 & 36 (10/26) & 58.5 (13.2) & 0.52 (0.38) & 4.5 (1.7) & 10.83 (38.77) \\
r038 & 72 (30/42) & 66.5 (21.2) & 0.78 (0.66) & 2.9 (2.3) & 11.53 (41.64) \\
r040 & 57 (32/25) & 64.0 (22.0) & 0.40 (0.50) & 1.8 (1.5) & 14.72 (58.63) \\
r047 & 2 (1/1) & 71.0 (2.0) & 0.59 (0.26) & 4.4 (0.2) & 23.78 (19.19) \\
r049 & 21 (12/9) & 65.0 (16.0) & 0.95 (0.00) & 0.0 (0.0) & 1.30 (2.18) \\
r050 & 14 (7/7) & 68.0 (16.8) & 0.92 (0.10) & 0.0 (0.0) & 0.33 (0.40) \\
r053 & 52 (20/32) & 63.5 (20.5) & 0.92 (0.17) & 3.0 (3.0) & 13.50 (28.27) \\
r054 & 12 (5/7) & 65.5 (11.8) & 0.67 (0.83) & 0.4 (0.2) & 4.06 (14.15) \\
 & & & & &\\
\textbf{Chronic}  & & & & &\\
\arrayrulecolor{black!30}\midrule
r001 & 39 (10/29) & 61.0 (17.0) & 0.65 (0.23) & 23.5 (40.0) & 6.27 (18.06) \\
r002 & 12 (6/6) & 69.5 (11.5) & 0.50 (0.41) & 73.2 (51.9) & 28.24 (31.71) \\
r003 & 15 (6/9) & 61.0 (16.5) & 0.24 (0.20) & 48.8 (67.6) & 20.28 (76.88) \\
r004 & 19 (7/12) & 44.0 (14.5) & 0.17 (0.16) & 50.4 (81.9) & 36.85 (44.29) \\
r005 & 27 (12/15) & 66.0 (16.5) & 0.79 (0.45) & 31.4 (27.8) & 1.61 (40.27) \\
r009 & 60 (17/43) & 71.0 (7.2) & 0.96 (0.12) & 27.4 (9.3) & 1.43 (4.65) \\
r025 & 16 (3/13) & 64.5 (13.2) & 0.98 (0.58) & 14.2 (10.2) & 5.92 (14.26) \\
r027 & 28 (8/20) & 57.0 (10.2) & 0.30 (0.16) & 19.3 (24.7) & 12.30 (62.13) \\
r028 & 21 (6/15) & 63.0 (9.0) & 0.82 (0.24) & 26.5 (37.5) & 5.25 (41.28) \\
r031 & 1 (0/1) & 52.0 (0.0) & 0.68 (0.00) & 6.1 (0.0) & 1.54 (0.00) \\
r034 & 15 (6/9) & 58.4 (11.1) & 0.82 (0.20) & 61.3 (68.3) & 6.68 (34.99) \\
r035 & 15 (6/9) & 64.0 (18.0) & 0.64 (0.52) & 33.5 (22.9) & 3.89 (31.56) \\
r038 & 18 (7/11) & 67.0 (10.0) & 1.00 (0.12) & 15.1 (10.1) & 1.98 (1.63) \\
r040 & 14 (7/7) & 63.5 (9.8) & 0.68 (0.47) & 14.1 (17.5) & 8.65 (82.65) \\
r042 & 22 (11/11) & 48.5 (15.5) & 0.64 (0.19) & 29.6 (36.4) & 14.16 (49.53) \\
r044 & 4 (0/4) & 68.0 (9.2) & 0.52 (0.25) & 43.7 (52.9) & 23.65 (67.00) \\
r045 & 4 (1/3) & 62.0 (5.2) & 0.49 (0.24) & 96.1 (59.0) & 7.97 (6.66) \\
r046 & 11 (3/8) & 62.0 (10.5) & 0.50 (0.29) & 86.3 (83.4) & 4.62 (19.82) \\
r047 & 44 (14/30) & 65.5 (12.0) & 0.65 (0.44) & 38.1 (53.7) & 12.72 (41.33) \\
r048 & 43 (16/27) & 68.0 (12.5) & 0.79 (0.44) & 46.2 (49.8) & 7.93 (43.45) \\
r052 & 32 (12/20) & 63.0 (13.5) & 0.41 (0.09) & 39.1 (42.2) & 6.98 (51.55) \\
 & & & & &\\
\textbf{All}  & & & & &\\
\arrayrulecolor{black!30}\midrule
& 789 (293/496) & 64.0 (18.0) & 0.7 (0.5) & 12.2 (0.2) & 6.45 (32.48) \\
\bottomrule
\end{tabular}
\end{table}

\subsection{General overview}

We built several models to predict chronic motor scores from imaging data and minimal clinical information. Each model uses lesion-derived information as input to predict normalized motor scores in chronic stroke subjects. We compared several different features that reflect different aspects of lesion damage. These features include: lesion load to M1 (1 feature), lesion load several sub-branches of the CST (6 features per hemisphere) structural lesion-behavior mapping components (5 features based on \cite{Bowren2022-rs}), and measures of structural disconnection reflecting damage to gray matter regions across the entire brain (86 or 268 features, fewer with features selection). We assessed whether data-driven feature selection improved performance for models using whole-brain measures of structural disconnection. Nested cross-validation was performed for all measures to train models and assess performance on unseen data.  Additionally, we evaluated whether including acute subjects in the training set (but not in the test set) improved prediction of chronic deficits, with the idea that the signal in the acute data would be useful in predicting deficits in the chronic phase. We also evaluated whether adding basic clinical information (age, sex, time since stroke) via ensemble models improved performance. Finally, we assessed whether using ensemble models to combine predictions from multiple different lesion damage metrics improved performance.

\subsubsection*{Machine learning framework}
Models differed for each lesion biomarker based on the data; see below (3.3 Description of models and their inputs) for implementation details for each biomarker. In general, regression models were trained and evaluated using repeated 5-fold nested cross-validation loop.  In the outer loop, the data was split into 5 training and test partitions. Using only chronic data to train the models, there were approximately 370 subjects in the training set and 92 subjects in the test set. If acute data was used in training, it was added to the training partition, such that there were 696 subjects in the training set and 92 subjects in the test set. Training data was further partitioned into training and validation sets in the inner loop, and if hyperparameters were specified in the model, they were optimized in the inner loop. 

Out-of-sample performance was calculated as the average performance across 5 outer test folds. We obtained a distribution of out-of-sample performance by splitting the data into 5 train/test folds 100 times, shuffling the indices of the splits each time. 

\subsubsection*{Model performance}
Model performance was assessed by comparing true normalized motor scores with predicted scores. Performance was calculated with Pearson's correlation coefficient and by the explained variance score, or $R^2$, which captures the percent of variation in motor scores explained by variation in the model predictors. Two performance metrics were used in order to compare results with prior literature, which uses both.

\subsection{Description of models and their inputs}
\subsubsection*{Primary motor cortex CST lesion load (M1-CST-LL) models}

The lesion load of the corticospinal tract originating from the primary motor cortex (M1-CST-LL) has been associated with motor impairment in several stroke studies (\cite{Stinear2017-eg}). Here, as in previous work, M1-CST-LL was calculated as the proportion of lesioned voxels intersecting with a binarized ipsilesional M1-CST template (\cite{Zhu2010-qh}). Specifically, lesion load was calculated in 1mm MNIv6 space as:
\begin{equation}
    \textit{Lesion load} = \frac{\textit{Number of lesioned voxels intersecting with  tract}}{\textit{Number of voxels in tract}}
\end{equation}
Left and right hemisphere M1-CST segmentations in MNI space were obtained from the high-resolution sensorimotor area tract template (SMATT) (\cite{Archer2018-ti}). M1-CST-LL had a heavy-tailed distribution (Supplementary Figure \ref{lesion_load_dist}A).
Linear regression was used to model the relationship between ipsilesional M1-CST-LL and chronic motor scores. The weights from best-performing model in the inner loop were used to predict motor scores for new subjects in the test folds. 

\subsubsection*{Sensorimotor tract lesion load  (SMATT-LL) models}
Sensorimotor tract segmentations were obtained from the sensorimotor area tract template (SMATT) (\cite{Archer2018-ti}), a set of 12 tracts derived from probabilistic tractography seeded in the left and right primary motor cortex (M1), dorsal and ventral premotor cortex (PMd and PMv, respectively), supplementary motor area (SMA), pre-supplementary motor area (pre-SMA), and primary somatosensory cortex (S1) of healthy controls (Figure \ref{smatt_and_chaco}A). Lesion load was calculated as above, for all 12 tracts, i.e., separately for left and right hemispheres, referred to as L/R SMATT-LL, and for the 6 ipsilesional tracts, referred to as Ipsilesional SMATT-LL. L/R SMATT-LL was calculated in order to assess whether preserving hemispheric information improved predictions. For subjects with brainstem, cerebellar, and/or bilateral cerebral strokes (N=30 chronic, N=43 acute), ipsilesional lesion load was calculated as the average lesion load of the left and right hemisphere tracts. Lesion loads also had a heavy-tailed distribution (Supplementary Figure \ref{lesion_load_dist}B,C). 

\begin{figure}
\begin{subfigure}{1\textwidth}
   \includegraphics[width=1\linewidth]{figures/SMATT.png}
    \caption{Sensorimotor tract template atlas (SMATT), displaying only right hemisphere tracts relative to an MNI template. Includes supplementary motor area (SMA), dorsal premotor cortex (PMd), ventral premotor cortex (PMv), pre-supplementary motor area (pre-SMA), primary sensory cortex (S1),  and primary motor cortex (M1). Pre-SMA is the most anterior tract, S1 is the most posterior tract.}
    \label{smatt}
  \label{fig:sfig1}
\end{subfigure}
\begin{subfigure}{1\textwidth}
  \includegraphics[width=1\linewidth]{figures/Multi-panelML_white_regional.png}
  \caption{Overview of the Network Modification tool. Binary lesion masks in MNI space representing the presence of a stroke lesion (turquoise) in a given voxel are provided by the user. Each lesion mask is embedded into 420 unrelated healthy structural connectomes (separately for each healthy subject) and the regional or pairwise change in connectivity (ChaCo) scores are calculated and averaged across healthy subjects (parcellation shown here is the Shen 268-region atlas). }
  \label{fig:sfig2}
\end{subfigure}
\caption{Distribution of number of features selected in ChaCo models (fs86 left, shen268 right) vs. amount of regularization.}
\label{smatt_and_chaco}
\end{figure}

Ridge regression models were used to predict chronic motor deficits from ipsilesional SMATT-LL (6 features) and from L/R-SMATT-LL (12 features). Ridge regression was used to account for multicollinearity of lesion load values between tracts (Supplementary Figure \ref{smatt_pairwise_correlations}, \ref{smatt_pairwise_correlations_bi}). Lesion load values were normalized (after train/test split) by subtracting the mean across subjects and dividing by the l2-norm prior to model fitting. In the inner loop, the degree of regularization on regression coefficients ($\lambda$) was determined via. grid-search, searching over 30 values ranging [$10^-2$ to $10^2$]. The training data was fit with the selected $\lambda$ and this model was used to predict motor scores for new subjects in the test folds.

\subsubsection*{Structural lesion-network mapping models}
Structural lesion network maps were obtained from \cite{Bowren2022-rs}. Specifically, \cite{Bowren2022-rs} produced maps of white matter (WM) voxels that are associated with Fugl-Meyer scores using sparse canonical corrleations analysis (\cite{Pustina2018-xv}). Then, tractography was seeded from peak WM voxels to identify tracts that pass through peak voxels, which produced structural lesion network maps (sLNMs). PCA of sLNMs was performed because there was > 1 peak voxel, which produced 3 principal components that correspond to 5 maps (PC1, and positive/negative weights of PC2 and PC3 split). Lesion load on each principal component map was calculated for each subject as the sum of the voxel intensities from the principal component map that also appeared within the boundaries of a lesion mask (Supplementary Figure \ref{slnm_distribution}). Ridge regression models were used to predict chronic motor deficits from sLNM lesion loads (5 features). As above, lesion load values were normalized (after train/test split) by subtracting the mean across subjects and dividing by the l2-norm prior to model fitting. In the inner loop, the degree of regularization on regression coefficients ($\lambda$) was determined via. grid-search, searching over 30 values ranging [$10^-2$ to $10^2$]. The training data was fit with the selected $\lambda$ and this model was used to predict motor scores for new subjects in the test folds. 

\subsubsection*{Regional change in connectivity (ChaCo) models}
Lesion masks in $1mm^3$ MNI v6 space were processed with the Network Modification Tool (NeMo Tool) v2 pipeline (\cite{Kuceyeski2013-nk}) (https://github.com/kjamison/nemo for more detailed information). Given a lesion mask, the NeMo tool produces outputs that reflect the impact of the lesion on white matter tracts on the brain using healthy structural connectomes as a reference. The NeMo tool embeds a lesion mask into healthy structural connectomes, identifies all white matter streamlines that intersect with the lesion, and determines the brain regions at the endpoints of those streamlines (Figure \ref{smatt_and_chaco}B). Regional change in connectivity (ChaCo) scores, or the ratio of the number of disrupted streamlines divided by the total number of streamlines terminating in each region, were calculated for all grey matter regions (see Supplementary Figure \ref{sumchaco_acutechronic} for distribution of ChaCo scores across subjects). The NeMo tool uses structural connectivity from 420 unrelated subjects from the Human Connectome Project Young Adult database. For each stroke lesion, the NeMo tool calcualtes regional ChaCo scores for all HCP subjects separately and then produces final regional ChaCo scores by taking the mean across HCP subjects. Structural connectivity in HCP subjects was obtained using deterministic tractography (SD stream) with dynamic seeding, with additional SIFT2 weighting for each of 5 million streamlines (\cite{Smith2015-eb}). Regional ChaCo scores from two different altases were compared: the 86-region Desikan-Killiany Atlas (68 cortical regions $\Plus$ 18 subcortical regions, excluding brainstem) from FreeSurfer ("fs86" for short), which contains coarse anatomically parcellated regions (\cite{Desikan2006-vf,Fischl2002-lb}), and the 268-region Shen atlas ("shen268" for short), which contains more fine-grained functionally parcellated cortical and subcortical regions (\cite{Shen2013-zn}).

First, the performance of ridge regression models was assessed, as described above, with regional ChaCo scores as inputs (86 features for the fs86 atlas, 268 features for the shen268 atlas). Second, a filter-based feature selection step was added to ridge regression models to obtain a subset of features that were the most useful for prediction (\cite{Guyon2003-kj, Hall1999-qr, Pudjihartono2022-zg}). We mixed hyperparameter tuning and feature selection in the same step, considering the number of features as a hyperparameter itself. Features were ranked by their their association with the outcome variable (p-value from univariate correlation) . In the inner loop, both the amount of regularization on regression coefficients ($\lambda$) and the number of features to retain in the feature selection step ($\kappa$) were selected via. grid search. The $\lambda$ value was chosen by searching over 30 values ranging [$10^-2$ to $10^2$], and the $\kappa$ value was chosen by searching 30 values ranging from 5 to the maximum number of features possible (for fs86: 86, for shen268: 268) in base-2 steps. 

\subsubsection*{Ensemble models}

We tested whether models including demographic information (age, sex, and days post stroke) alongside lesion data will perform better than models with lesion data or demographic data alone (i.e., variance explained from lesion data and demographic data is not redundant). We also assessed whether models including both lesion load and ChaCo scores will perform better than models with lesion load or ChaCo scores alone. The idea of ensemble learning is to build a single prediction model by combining the strengths of a collection of simpler base models; we used ensemble models that average predictions from different damage metrics (\cite{Hastie2001-or}).

Ensemble models were generated by training ChaCo-models and lesion load models separately, on the same subjects and with the same training/test/validation splits, and averaging the final predicted scores for each subject. A standard linear regression model was used to model the relationship between demographic information and motor impairment. 

\subsubsection*{Model comparisons}
Differences in performance between models were assessed using two-sided Mann-Whitney U tests. P-values were corrected for multiple comparisons using the Bonferroni correction. 

\subsubsection*{Code availability}
All analysis scripts that generated the results of the present study are readily accessible and open for reuse (https://github.com/emilyolafson/lesion$\_$predictions). The script can be easily modified to predict any outcome score from ChaCo scores/lesion load data.

\section{Results}
The relative out-of-sample performances of the models can be found in Figure \ref{analysis1}A,B. M1 CST-LL, SMATT-LL, and sLNM-LL performed worse on average than ChaCo models, with Left/Right SMATT-LL models performing the best among them (correlation = 0.446, $R^2$ = 0.188) and M1 CST-LL models performing the worst (correlation = 0.395, $R^2$ = 0.133, n.d. between chronic and mixed training data). 

\begin{figure}[htp]
\centering
\includegraphics[width=1\linewidth]{figures/Analysis1.png}
\caption{Summary of model performance metrics across all models tested and feature weights (regression coefficients) for best-performing models.  \textbf{A.} and \textbf{B.} Distribution of model performance (mean Pearson correlation/$R^2$ across 5 outer folds for 100 permutations of the data).  Boxplots are colored abritrarily for clarity and are plotted in similarly-colored pairs to indicate performance using the full training data ("Acute $\Plus$  chronic") versus only chronic data ("Chronic only"). The boxes extend from the lower to upper quartile values of the data, with a line at the median. Whiskers represent the range of the data from [Q1-1.5*IQR, Q3+1.5*IQR].
\textbf{C.} and \textbf{D.} Mean feature weights for the top 2 best-performing models (fs86-ChaCo without feature selection, shen268-ChaCo with feature selection, respectively). For fs86-ChaCo (left), displaying mean regression coefficients across 100 permutations. For shen268-ChaCo (right), displaying mean regression coefficients for regions that were selected in at least 99$\%$ of the models (i.e., were included in the model in at least 495/500 outer folds). }
\label{analysis1}
\end{figure}



The effect of feature selection in ChaCo models depended on the atlas: for fs86, feature selection reduced model performance, whereas for shen268, model selection improved it. In general, including additional acute subjects in the training data improved performance of the models, despite the difference in motor scores between acute and chronic cohorts. 

Regional ChaCo scores from the shen268 atlas best predicted chronic motor scores in unseen subjects, using acute and chronic data for training and a feature selection step to identify a subset of relevant features (correlation = 0.467, $R^2$ = 0.210), and were on par with regional ChaCo scores from the 86-region FreeSurfer atlas, also acute and chronic data for training (correlation = 0.458, $R^2$ = 0.204, n.d. between models). 

Beta coefficients for ChaCo models are shown in (Figure \ref{analysis1}C, D) (reflecting features selected in least 495/500 outer folds of the shen268 models). There were several similarities in the pattern of feature weights in the fs86 ChaCo model and shen268 ChaCo model with feature selection. For both atlases, negative model weights are assigned to superior portions of left and right motor areas, as well as in subcortical structures like the putamen, pallidum, and thalamus, whereas positive weights are assigned to frontal and parietal areas. In then shen268 models, more regions in the right hemisphere are consistently included in the model.

In the shen268 ChaCo models with feature selection, on average, 110 features were selected (Supplementary Figure \ref{lambda_kappa}). A hierarchically-clustered heatmap of the correlation matrix of the selected features (Supplementary Figure \ref{heatmap_shen_negweights}) shows that many of the selected features are clustered (i.e., high correlation in damage across subjects), reflecting some degree of redundancy in the variables selected. Additionally, ChaCo scores of regions with positive and negative regression weights were positively correlated across subjects, despite these features having opposite relationships to motor deficits (Supplementary Figure \ref{heatmap_shen_pos_vs_negative}). Although two regions may have strong lesion-anatomical relationships (i.e., are adjacent and therefore usually damaged together), they have distinct relationships to motor deficits. 

Curiously, in the majority of cross-validation folds, all 86 regions were selected in the model. This may reflect something about why the performance was worse with feature selection and worse than shen268 in general: perhaps more features are needed to model the relationship.


\newpage 
\newpage

\begin{table}[h]
\centering
\label{table:5}
\begin{tabular}{lrrll}
\toprule
 &  & \multicolumn{2}{c}{Median performance} \\
Ensemble type & Model name & Correlation & $R^2$  \\
\midrule
\multirow[t]{8}{*}{None (Lesion load or} & M1 CST-LL & 0.395 & 0.133 \\
 ChaCo only)& Ipsi. CST-LL & 0.430 & 0.174 \\
 & L/R CST-LL & 0.446 & 0.188 \\
 & sLNM-LL & 0.427 & 0.165 \\
 & ChaCo (fs86) & 0.458 & 0.204 \\
 & ChaCo (shen268) & 0.456 & 0.199 \\
 & ChaCo (fs86) (feat. select.) & 0.447 & 0.191 \\
 & ChaCo (shen268) (feat. select.) & 0.467 & 0.210 \\
\multirow[t]{16}{*}{Lesion load $\Plus$} & M1 CST-LL + ChaCo (fs86subj) & 0.461 & 0.210 \\
 ChaCo & M1 CST-LL + ChaCo (shen268) & 0.463 & 0.211 \\
 & Ipsi. CST-LL + ChaCo (fs86subj) & 0.478 & 0.226 \\
 & Ipsi. CST-LL + ChaCo (shen268) & 0.481 & 0.228 \\
 & L/R CST-LL + ChaCo (fs86subj) & 0.481 & 0.227 \\
 & L/R CST-LL + ChaCo (shen268) & 0.481 & 0.228 \\
 & sLNM-LL + ChaCo (fs86subj) & 0.468 & 0.214 \\
 & sLNM-LL + ChaCo (shen268) & 0.472 & 0.217 \\
 & M1 CST-LL + ChaCo (fs86subj) (feat. select.) & 0.458 & 0.206 \\
 & M1 CST-LL + ChaCo (shen268) (feat. select.) & 0.469 & 0.217 \\
 & Ipsi. CST-LL + ChaCo (fs86subj) (feat. select.) & 0.476 & 0.223 \\
 & Ipsi. CST-LL + ChaCo (shen268) (feat. select.) & 0.485 & 0.233 \\
 & L/R CST-LL + ChaCo (fs86subj) (feat. select.) & 0.475 & 0.222 \\
 & L/R CST-LL + ChaCo (shen268) (feat. select.) & 0.486 & 0.232 \\
 & sLNM-LL + ChaCo (fs86subj) (feat. select.) & 0.462 & 0.208 \\
 & sLNM-LL + ChaCo (shen268) (feat. select.) & 0.474 & 0.222 \\
\multirow[t]{8}{*}{Demographics} & M1 CST-LL + demog. & 0.424 & 0.173 \\
 & Ipsi. CST-LL + demog. & 0.457 & 0.199 \\
 & L/R CST-LL + demog. & 0.462 & 0.203 \\
 & sLNM-LL + demog. & 0.452 & 0.191 \\
 & ChaCo (fs86) + demog & 0.471 & 0.203 \\
 & ChaCo (shen268) + demog & 0.468 & 0.204 \\
 & ChaCo (fs86) (feat. select.) + demog & 0.465 & 0.201 \\
 & ChaCo (shen268) (feat. select.) + demog & 0.481 & 0.215 \\
\multirow[t]{16}{*}{Lesion load $\Plus$} & M1 CST-LL + ChaCo (fs86subj) + demog. & 0.476 & 0.214 \\
 ChaCo $\Plus$ & M1 CST-LL + ChaCo (shen268) + demog. & 0.477 & 0.216 \\
 Demographics & Ipsi. CST-LL + ChaCo (fs86subj) + demog. & 0.492 & 0.230 \\
 & Ipsi. CST-LL + ChaCo (shen268) + demog. & 0.495 & 0.232 \\
 & L/R CST-LL + ChaCo (fs86subj) + demog. & 0.494 & 0.231 \\
 & L/R CST-LL + ChaCo (shen268) + demog. & 0.494 & 0.232 \\
 & sLNM-LL + ChaCo (fs86subj) + demog. & 0.484 & 0.222 \\
 & sLNM-LL + ChaCo (shen268) + demog. & 0.487 & 0.224 \\
 & M1 CST-LL + ChaCo (fs86subj) (feat. select.) + demog. & 0.472 & 0.212 \\
 & M1 CST-LL + ChaCo (shen268) (feat. select.) + demog. & 0.482 & 0.222 \\
 & Ipsi. CST-LL + ChaCo (fs86subj) (feat. select.) + demog. & 0.490 & 0.228 \\
 & Ipsi. CST-LL + ChaCo (shen268) (feat. select.) + demog. & 0.498 & 0.237 \\
 & L/R CST-LL + ChaCo (fs86subj) (feat. select.) + demog. & 0.490 & 0.229 \\
 & L/R CST-LL + ChaCo (shen268) (feat. select.) + demog. & 0.499 & 0.237 \\
 & sLNM-LL + ChaCo (fs86subj) (feat. select.) + demog. & 0.479 & 0.218 \\
 & sLNM-LL + ChaCo (shen268) (feat. select.) + demog. & 0.492 & 0.230 \\
 
 \arrayrulecolor{black}\bottomrule
\end{tabular}
\caption{Test performance of all models evaluated, displaying median $R^2$ and median correlation of average hold-out performances (i.e. average across 5 outer folds) across 100 permutations. Demog. = demographics, Ipsi. = Ipsilesional, SMATT LL = sensorimotor tract template lesion load, L/R SMATT LL = left and right sensorimotor tract template lesion load, M1 CST LL = M1 corticospinal tract lesion load, ChaCo = Change in Connectivity, fs86 = FreeSurfer 86-region atlas, feat. select. = feature selection}
\label{results_table_acutechronic}

\end{table}






\begin{figure}[htp]
\centering
\includegraphics[width=1\linewidth]{figures/analysis_1_matrix_figure_colors.png}
\caption{Significant differences in model performance for prediction of normalized motor scores. Difference in explained variance between pairs of models using different lesion metrics and different training data. Model differences were calculated by averaging the difference in explained variance for each of the 100 train/test splits. Significance of differences in explained variance were evaluated using exact tests for differences. $***$ denotes corrected $p < 0.001$, $**$ denotes corrected $p < 0.01$, $*$ denotes corrected $p < 0.05$ after Bonferroni correction. A positive difference value indicates that the model on the y-axis (vertical) has a greater explained variance than the model on the x-axis (horizontal).
 }
\label{analysis1}
\end{figure}

\begin{figure}[htp]
\centering
\includegraphics[width=1\linewidth]{figures/Analysis2.png}
\caption{Ensemble model results. coefficients and model performance using Group KFold cross-validation (test/validate on independent imaging site). \textbf{A.} and \textbf{B.} display regression coefficients for regional ChaCo scores (FreeSurfer 86-region atlas, and Shen268-region atlas, respectively). Average feature weights for regions that were selected in at least half of the models (i.e., were included in the model in at least 250/500 outer folds). \textbf{C.} Sensorimotor area tract template feature importance for analysis 2. Includes primary motor cortex (M1), dorsal premotor cortex (PMd), ventral premotor cortex (PMv), supplementary motor area (SMA), pre-supplementary motor area (pre-SMA), primary sensory cortex (S1).}
\label{nemotool}
\end{figure}

\section{Discussion}
In this study, we assessed the relative predictive performance of several lesion metrics on the same large imaging dataset. We found that modelling lesion damage using regional ChaCo scores and using correlation-based feature selection best predicted chronic motor scores. Models using features derived from multivariate voxelwise lesion-behavior modelling performed worse than more basic models using damage to parcellations of the descending corticospinal tract. Finally, we saw that combining several lesion metrics using ensemble modelling improved prediction performance, and using acute stroke data to train models for prediction of chronic scores improved prediction performance. 

This study confirms previous studies that M1-CST-LL does not capture enough variance to predict chronic motor outcomes in wide range of lesion topographies (\cite{Rondina2017-ij, Park2016-te, Ito2022-em, Boyd2017-gs}), although few studies have directly compared the out-of-sample performance of M1-CST-LL against more complex metrics. 

Models using ChaCo scores performed better than M1-CST-LL and SMATT-LL models, particularly when feature selection was employed. ChaCo scores are able to capture white matter and grey matter damage in one measurement (\cite{Kuceyeski2013-nk}), which may enable them to capture relevant associations between grey matter damage and motor disruption (\cite{Rondina2016-ds}) that are not captured with lesion load metrics of tract damage.

Further, feature selection only improved model performance for ChaCo scores of the 268-region Shen atlas. Two aspects of this model likely contributed to its success: first, correlation-based feature selection identified patches of correlated damage (hence the observed clustering in the correlation matrix of selected predictors) (discussions on patch size: \cite{Pustina2018-xv, Sperber2020-kp}). Second, the small size of parcels in the 268-region atlas allowed for preservation of signal in relevant individual gray matter regions. This preserved, unique signal in individual regions can also be inferred from the correlation matrix of selected predictors, where several regions are consistently incorporated into the model but have low correlation with other selected regions. 

Further investigation into the features that were most consistently selected can give insight into the performance of the model. Correlation-based feature selection is known to choose redundant features (Guyon). Indeed, damage to many selected regions is highly correlated, suggesting that information from these regions is somewhat redundant. Does this mean that our model is suboptimal, and that fewer features are actually necessary for good predictions? No; in the context of lesion-deficit modelling, damage to adjacent regions can be highly correlated because they are supplied by the same vascular territory, and a stroke in that artery will cause damage to both areas. One may therefore expect that many regions share the same lesion-deficit association due to shared vasculature, and that damage to several areas, regardless of their causal relationship to hemiparesis, may be useful for predicting deficits. That the feature selection identified such clusters of correlated damage is expected performance of the model based on the non-random distribution lesions and their relationship to deficits. Curiously, although damage to consistently-selected regions was positively correlated (or had minimal correlation), the weights assigned to those features were mixed. The left ventral motor cortex is consistently damaged with the area directly posterior to it (Supp fig). However, damage to left ventral motor cortex is negatively related to motor outcomes and damage to the region directly posterior has a positive association with motor outcomes. The sample size may be sufficiently large, with enough small lesions, that we can parse out differential lesion-deficit associations in areas that are highly correlated. Likely, the increased statistical power obtained by modelling structural disconnection and small parcel size in the shen268 atlas enabled this finer mapping. 


On the other hand, the 86-region FreeSurfer parcellation may have been too coarse, and relevant signal may have been diluted across large gray matter regions, or more components were needed to adequately model the relationship between lesion damage and deficits. Fisgure 2 maps are not hemiparesis maps per se. Indeed, if the goal of an analysis is to merely to optimize predictive accuracy in unseen subjects using lesion data, it is less relevant that features are causally related to motor function at all (\cite{Price2017-co, Sperber2020-kp}). An open question remains to what extent non-causally associated features are robust to distribution shifts.

Perhaps the most surprising result of this paper is the poor performance of sLNM models relative to ChaCo models. The difference between the two models relates to when lesion-induced white matter damage is calculated. In both models, features reflecting lesion-induced damage are selected via optimization procedures on the basis of those features contributing to the prediction of motor deficits in a held-out sample; i.e., the features are selected in a data-driven way. However, in sLNM models, those features are voxels, and in ChaCo models, those features are regional ChaCo scores. Although sLNM identifies the white matter tracts that pass through voxels important for predictions and uses damage to those tracts as input to predictive models, the variables on which feature selection takes place are voxels. False negatives may result from this type of modelling when partial damage of larger neural correlates produces a deficit (Sperber et al., 2022) because there are simply fewer instances in which damage to that area produces a deficit. When voxelwise lesion data is first transformed into regional ChaCo scores, statistical power is increased: damage to cortical and subcortical grey matter as well as associated projection fibers is collapsed into change in connectivity scores of a subset of regions. 

Inclusion of the acute data improved predictions. Although in this paper we did not attempt to disentangle the effect of greater training size from relevance of the signal in the acute data, we can say that the acute data was at least not harmful. In particular, feature selection seemed to only improve performance when acute data was included in the training set. If the statistical relationships between lesion and deficits changed over the course of the stroke then this information may not be useful. Therefore, there is some helpful signal in this population. Likely, unmeasured factors like therapy, comorbidities, and lifestyle weaken the underlying relationship between lesion location and motor deficit as time between the stroke and the assessment increases. We may also conclude that because of this shared variance, predictive performance in acute subjects can be thought of as an upper limit of performance achieveable on chronic data.

Ensemble results: averaging predictions from multiple models improves performance above either model alone. This suggests that the information within each is not redundant, and that using multiple different lesion metrics may compensate for weaknesses of different feature representations. 

Limitations:
- no initial motor scores; there is likely overlap between the variance in chronic outcomes explained by baseline impairment and the variance in chronic outcomes explained by lesion measures. Since this information would likely be accessible for future clinical trials or prediction use cases, it remains to be seen to what degree lesion information provides variance above baseline lesion measures. There is reason to believe that this is true, with proportional recovery rule not holding in all cases and INSERT EXAMLPES OF BASELINE MOTOR IMPAIRMENT NOT BEING CORRELATED WITH CHRONIC IMPARIMENT).

- Mix of different measures may be limited the SNR of the results, e.g. fugl meyer UE versus other measures of motor function that are more broad and measures of function in general. 

- 

\clearpage



\printbibliography
\section*{Supplementary Results}

\beginsupplement
\begin{figure}[ht]
\centering
\includegraphics[width=0.8\linewidth]{figures/distribution_lesions.png}
\caption{Distribution of lesions in ENIGMA cohort.}
\label{lesiondist}
\end{figure}


\begin{table}[h]
\centering
\caption{Number of subjects with data for each type of assessment, broken down by chronicity (acute/chronic) and site. FMA UE = Fugl Meyer Assessment of Upper Extremity [0-66], Barthel = Barthel Index [0-100], NIHSS (National Institutes of Health Stroke Score) [0-42], ARAT = Action Research Arm Test [0-57]}
\label{motor_scores}
\begin{tabular}{lrlllllll}
\toprule
 & Total N. & FMA-UE  & Barthel & NIHSS  & ARAT \\
 & & &  &  \\
 \textbf{Acute}  & & & & & \\
\arrayrulecolor{black!30}\midrule
r005 & 1 & 1 & 0 & 0 & 0 \\
r009 & 50 & 0 & 0 & 50 & 0 \\
r025 & 9 & 9 & 0 & 0 & 0 \\
r028 & 1 & 1 & 0 & 0 & 0 \\
r031 & 36 & 36 & 0 & 0 & 0 \\
r038 & 72 & 0 & 72 & 0 & 0 \\
r040 & 57 & 0 & 57 & 0 & 0 \\
r047 & 2 & 2 & 0 & 0 & 0 \\
r049 & 21 & 0 & 0 & 21 & 0 \\
r050 & 14 & 0 & 0 & 14 & 0 \\
r053 & 52 & 0 & 0 & 52 & 0 \\
r054 & 12 & 12 & 0 & 0 & 0 \\

& & & & & \\
 \textbf{Chronic}  & & & & & \\
\arrayrulecolor{black!30}\midrule
r001 & 39 & 39 & 0 & 0 & 0 \\
r002 & 12 & 12 & 0 & 0 & 0 \\
r003 & 15 & 15 & 0 & 0 & 0 \\
r004 & 19 & 19 & 0 & 0 & 0 \\
r005 & 27 & 27 & 0 & 0 & 0 \\
r009 & 60 & 0 & 0 & 60 & 0 \\
r025 & 16 & 16 & 0 & 0 & 0 \\
r027 & 28 & 28 & 0 & 0 & 0 \\
r028 & 21 & 21 & 0 & 0 & 0 \\
r031 & 1 & 1 & 0 & 0 & 0 \\
r034 & 15 & 15 & 0 & 0 & 0 \\
r035 & 15 & 15 & 0 & 0 & 0 \\
r038 & 18 & 0 & 18 & 0 & 0 \\
r040 & 14 & 0 & 14 & 0 & 0 \\
r042 & 22 & 22 & 0 & 0 & 0 \\
r044 & 4 & 4 & 0 & 0 & 0 \\
r045 & 4 & 4 & 0 & 0 & 0 \\
r046 & 11 & 11 & 0 & 0 & 0 \\
r047 & 44 & 44 & 0 & 0 & 0 \\
r048 & 43 & 43 & 0 & 0 & 0 \\
r052 & 32 & 32 & 0 & 0 & 0 \\
r053 & 2 & 0 & 0 & 2 & 0 \\
\bottomrule
\end{tabular}
\end{table}


\begin{figure}
\begin{subfigure}{0.5\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{figures/m1_lesionload.png}
  \caption{M1-CST lesion load distribution.}
  \label{fig:sfig1}
\end{subfigure}
\begin{subfigure}{0.5\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{figures/all_lesionload.png}
  \caption{Ipsilesional sensorimotor tract template (SMATT) lesion load distribution.}
  \label{fig:sfig2}
\end{subfigure}
\begin{subfigure}{1\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{figures/all2h_lesionload.png}
  \caption{Left and right hemisphere sensorimotor tract template (SMATT) lesion load distribution.}
  \label{fig:sfig2}
\end{subfigure}
\caption{Distribution of lesion load variables for chronic subjects.}
\label{lesion_load_dist}
\end{figure}


\begin{figure}[ht]
\centering
\includegraphics[width=1\linewidth]{figures/SMATT_scatterplts.png}
\caption{Correlations between lesion load calculated for each ipsilesional tract in the sensorimotor area tract template atlas.}
\label{smatt_pairwise_correlations}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=1\linewidth]{figures/SMATT_bi_scatterplts.png}
\caption{Correlations between lesion load calculated for each left and right hemisphere tract in the sensorimotor area tract template atlas.}
\label{smatt_pairwise_correlations_bi}
\end{figure}
\begin{figure}[ht]
\centering
\includegraphics[width=1\linewidth]{figures/slnmvalues_scatterplts.png}
\caption{Correlations between lesion load calculated for each structural lesion network-derived principal component map.}
\label{slnm_distribution}
\end{figure}



\begin{figure}[ht]
\centering
\includegraphics[width=1\linewidth]{figures/sum_chaco_fs86shen_surfaces.png}
\caption{Sum of regional change in connectivity (ChaCo) scores across chronic subjects. Sum of ChaCo scores parcellated with the FreeSurfer 86-region atlas (\textbf{A}) and with the Shen 268-region atlas (\textbf{B}, normalized to the maximum value across regions (red = higher sum of ChaCo score across subjects)}
\label{sumchaco_acutechronic}
\end{figure}


\begin{figure}[ht]
\centering
\includegraphics[width=1\linewidth]{figures/correlation_chaco_outcome.png}
\caption{Univariate correlation between regional ChaCo scores and normalized motor scores (chronic subjects).}
\label{corr_chaco_outcome}
\end{figure}



\begin{figure}[ht]
\centering
\includegraphics[width=1\linewidth]{figures/heatmap_shen268_correlation_negs.png}
\caption{Hierarchically-clustered heatmap of the correlation matrix of the selected features (ChaCo scores) with negative weights chosen in at least 99 percent of outer folds by correlation-based feature selection in ridge regression using the shen 268-region atlas. Heatmap (top left) displays values corresponding to correlation between features across subjects. Regions are labeled in the following format: "Hemisphere, lobe: Yeo Network".}
\label{heatmap_shen_negweights}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=1\linewidth]{figures/heatmap_shen268_correlation_pos_vs_neg.png}
\caption{Hierarchically-clustered heatmap of the correlation matrix of all selected features, split by negative and positive regression weights. Vertical (right) axis: regions with negative weights, horizontal (bottom) axis: regions with positive weights.  Regions are labeled in the following format: "Hemisphere, lobe: Yeo Network".}
\label{heatmap_shen_pos_vs_negative}
\end{figure}


\begin{figure}
\begin{subfigure}{0.5\textwidth}
  \includegraphics[width=1\linewidth]{figures/fs86subj_normed_motor_scores_chacovol_acutechronic_ridge_crossval1nfeats_lambdas.png}
  \caption{Number of features selected vs. lambda (amount of regularization) for model using ChaCo scores with the FreeSurfer 86-region atlas, acute and chronic subjects together in the training dataset, predicting noromed motor scores. Distribution is showing all training folds (i.e. 500 training folds, 5 folds x 100 permutations)}
  \label{fig:sfig1}
\end{subfigure}
\begin{subfigure}{0.5\textwidth}
  \includegraphics[width=1\linewidth]{figures/shen268_normed_motor_scores_chacovol_acutechronic_ridge_crossval1nfeats_lambdas.png}
  \caption{Number of features selected vs. lambda (amount of regularization) for model using ChaCo scores with the Shen 268-region atlas, acute and chronic subjects together in the training dataset, predicting normed motor scores.Distribution is showing all outer folds (i.e. 500 outer folds, 5 folds x 100 permutations)} 
  \label{fig:sfig2}
\end{subfigure}
\caption{Distribution of number of features selected in ChaCo models (fs86 left, shen268 right) vs. amount of regularization.}
\label{lambda_kappa}
\end{figure}




\end{document}